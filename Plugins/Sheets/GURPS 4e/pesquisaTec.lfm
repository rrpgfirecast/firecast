<?xml version="1.0" encoding="UTF-8"?>
<form name="pesquisaTec" margins="{bottom=10, right=10}" height="75" align="top">
<style>
label, edit, radioButton, checkBox, comboBox, button{
	fontSize: 14;
	fontFamily: Cambria;
	textTrimming: character;
}

label{
	fontColor: #cdcdcd;
}
</style>
	<rectangle name="recResult" align="client" color="#303030" padding="{top=10, left=20, bottom=10, right=20}" xradius= "10" yradius="10" cornerType="bevel">
		<layout name="layNomeeDif" align="top" height="20">
			<label name="lblTecNome" field="psqTecNome" align="client" textTrimming="character" fontStyle="bold" fontColor="white" />
			<label field="psqTecDif" align="right" horzTextAlign="trailing" width="95" />
		</layout>
		<label name="lblDesc" field="psqTecDescricao" align="top" height="30" fontSize="10" fontStyle="italic" textTrimming="character" wordWrap="true" />
		<label name="lblTecDefaults" field="psqTecDefaults" visible="false" />
		<label name="lblTecPrereq" field="psqTecPrerequisitos" visible="false" />
	</rectangle>
	<rectangle align="client" opacity="0" cursor="handPoint">
		<event name="onMouseEnter">
			self.recResult.color = '#404040'
		</event>
		<event name="onMouseLeave">
			self.recResult.color = '#303030'
		</event>
		<event name="onClick">
			local pop = self:findControlByName("popUp_");
					
			if pop ~= nil then
				pop:setNodeObject(sheet);
				pop:showPopupEx("right", self.recResult);
			else
				showMessage("Ops, n√£o encontrei o pop-up para exibir");
			end;
		</event>
	</rectangle>
	
	<template name="DivisorM">
		<layout align="top" height="12" margins="{top=0, bottom=5}">
			<label align="left" text="$(texto)" width="$(largura)" fontSize="10" fontFamily="Constantia" fontStyle="bold" />
			<horzLine align="client" margins="{top=5}" strokeColor="#424242" />
		</layout>
	</template>
	
	<popup name="popUp_" width="360" height="540" backOpacity="0" drawContainer="false" autoScopeNode="false">
		<rectangle align="client" color="#101010" padding="{top=5, left=5, bottom=5, right=5}" xradius= "10" yradius="10" cornerType="bevel">
			<rectangle align="client" color="#101010" padding="{top=15, left=15, bottom=15, right=0}" xradius= "7" yradius="7" cornerType="bevel" strokeSize="1" strokeColor="#424242">
				<layout align="top" height="40">
					<label field="psqTecNome" align="client" textTrimming="character" fontStyle="bold" fontColor="white" fontSize="20" />
					<label field="psqTecDif" align="right" horzTextAlign="trailing" width="95" margins="{right=15}" />
				</layout>
				<scrollBox align="top" height="400" padding="{bottom=40, right=15}">
					<DivisorM texto="D E F A U L T S" largura="70" />
					<label field="psqTecDefaults" align="top" autoSize="true" fontStyle="italic" margins="{bottom=20}" fontColor="#a0a0a0" />
					<DivisorM texto="P R E R E Q U I S I T E S" largura="110" />
					<label field="psqTecPrerequisitos" align="top" autoSize="true" margins="{bottom=20}" fontColor="#a0a0a0" />
					<DivisorM texto="D E S C R I P T I O N" largura="95" />
					<label field="psqTecDescricao" align="top" autoSize="true" fontColor="#a0a0a0" />
				</scrollBox>
				<layout align="top" height="30" margins="{top=20, right=15}">
					<button text="üûß" align="client" hint="Adicionar T√©cnica">
						<event name="onClick"><![CDATA[
							local difFinal, ptsFinal = nil
							if sheet.psqTecDif == "Average" then
								difFinal = "A"
								ptsFinal = "[01]"
							elseif sheet.psqTecDif == "Hard" then
								difFinal = "H"
								ptsFinal = "[02]"
							end
						
							local item = self:getParent():getParent():findControlByName('rlTecnicas'):append()
							
							item.nomeTec = sheet.psqTecNome
							item.dificuldadeTec = difFinal
							item.PtsTec = ptsFinal
							item.defaultsTec = sheet.psqTecDefaults
							item.prereqTec = sheet.psqTecPrerequisitos
							item.descTec = sheet.psqTecDescricao
							
							self:getParent():getParent():findControlByName('rlTecnicas').visible = false
							self:getParent():getParent():findControlByName('rlTecnicas').visible = true
							self:getParent():getParent():findControlByName('rlTecnicas'):sort()
							self:getParent():getParent():findControlByName('parteEsquerda'):needRepaint()
						]]></event>
					</button>
					<button text="üí¨" align="right" margins="{left=5}" width="30" hint="Enviar Descri√ß√£o no Chat">
						<event name="onClick"><![CDATA[
							local mesaDoPersonagem = Firecast.getMesaDe(sheet);
							local meuJogador = mesaDoPersonagem.meuJogador
							local meuNick = meuJogador.nick
							
							local msg = "üí¨ ".. meuNick .." [¬ßR][¬ßK2]destacou a T√©cnica:"
							msg = msg .. "\n****\n### [¬ßK1][¬ßB]".. sheet.psqTecNome .."[¬ßB]\n###### ".. sheet.psqTecDif
							msg = msg .. "\n [¬ßK1][¬ßB]Defaults:[¬ßB] [¬ßK14][¬ßT]".. sheet.psqTecDefaults .. "[¬ßT]"
							msg = msg .. "\n [¬ßK1][¬ßB]Prerequisites:[¬ßB] [¬ßK14]".. sheet.psqTecPrerequisitos
							msg = msg .. "\n [¬ßK1][¬ßB]Description:[¬ßB] [¬ßK14]".. sheet.psqTecDescricao
							msg = msg .. "[¬ßT]\n****"

							mesaDoPersonagem.activeChat:enviarMensagem(msg)
						]]></event>
					</button>
				</layout>
			</rectangle>
		</rectangle>	
	</popup>		
</form>
